<app-loading [isLoading]="isLoading"></app-loading>

<div *ngIf="!isLoading" class="container form">
    <div class="reg-img">
        <img src="/assets/register.png" alt="Register Image">
    </div>
    <div class="reg-form">
        <form id="register-form" #regForm="ngForm" (ngSubmit)="registerUser(regForm)">
            <h2><i class="bi bi-person-fill-add"></i> Register</h2>

            <app-alert-message [errorMsgFromServer]="errorMsgFromServer"></app-alert-message>

            <div class="form-group form-input">
                <input type="text" class="form-control" id="name" name="name" ngModel #inName="ngModel" [ngClass]="{'is-valid': inName.valid && inName.dirty, 
                    'is-invalid': inName.invalid && inName.dirty}" required minlength="2" maxlength="30">
                <label for="name" class="form-label">Your name</label>
                <div *ngIf="inName.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inName.errors?.['minlength']" class="invalid-feedback fs-6">
                    The Name must be at least 2 characters
                </div>
                <div *ngIf="inName.errors?.['maxLength']" class="invalid-feedback fs-6">
                    The name must be a maximum of 30 characters
                </div>
                <div *ngIf="inName.valid" class="valid-feedback fs-6">The field is valid</div>
            </div>
            <div class="form-group form-input">
                <input id="email" type="email" class="form-control" name="email" ngModel #inEmail="ngModel"
                    [ngClass]="{'is-valid': inEmail.valid && inEmail.dirty, 'is-invalid': inEmail.invalid && inEmail.dirty}"
                    required email pattern="^[\w]+@[\w]+\.[\w]+$">
                <label for="email" class="form-label">Email</label>
                <div *ngIf="inEmail.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inEmail.errors?.['email'] || inEmail.errors?.['pattern']" class="invalid-feedback fs-6">
                    The email entered is invalid
                </div>
                <div *ngIf="inEmail.valid" class="valid-feedback fs-6">The field is valid</div>
            </div>
            <div class="form-group form-input">
                <input id="phone" type="tel" class="form-control" name="phone" ngModel #inPhone="ngModel"
                    [ngClass]="{'is-valid': inPhone.valid && inPhone.dirty, 'is-invalid': inPhone.invalid && inPhone.dirty}"
                    required pattern="^\+\d{3}\d{3}\d{3}\d{3}$">
                <label for="phone" class="form-label">Phone</label>
                <div *ngIf="inPhone.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inPhone.errors?.['pattern']" class="invalid-feedback fs-6">
                    Please use the following format +359111222333</div>
                <div *ngIf="inPhone.valid" class="valid-feedback fs-6">The field is valid</div>
            </div>
            <div class="form-group form-input">
                <input id="address" type="text" class="form-control" name="address" ngModel #inAddress="ngModel"
                    [ngClass]="{'is-valid': inAddress.valid && inAddress.dirty, 'is-invalid': inAddress.invalid && inAddress.dirty}"
                    required minlength="5" maxlength="100">
                <label for="address" class="form-label">Enter your address</label>
                <div *ngIf="inAddress.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inAddress.errors?.['minlength']" class="invalid-feedback fs-6">
                    The address must be at least 5 characters long
                </div>
                <div *ngIf="inAddress.errors?.['maxLength']" class="invalid-feedback fs-6">
                    The address must be a maximum of 100 characters
                </div>
                <div *ngIf="inAddress.valid" class="valid-feedback fs-6">The field is valid</div>
            </div>
            <div class="form-group form-input">
                <input id="password" type="password" class="form-control" name="password" ngModel #inPass="ngModel"
                    [ngClass]="{'is-valid': inPass.valid && inPass.dirty, 'is-invalid': inPass.invalid && inPass.dirty}"
                    required minlength="6">
                <label for="password" class="form-label">Enter your password</label>
                <div *ngIf="inPass.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inPass.errors?.['minlength']" class="invalid-feedback fs-6">
                    Password must be at least 6 characters long
                </div>
                <div *ngIf="inPass.valid" class="valid-feedback fs-6">The field is valid</div>
            </div>
            <div class="form-group form-input">
                <input id="rePass" type="password" class="form-control" name="repass" ngModel #inRePass="ngModel"
                    [ngClass]="{'is-valid': inRePass.valid && inRePass.dirty && inRePass.value === inPass.value, 
                    'is-invalid': inRePass.dirty && inRePass.value !== inPass.value}" required minlength="6">
                <label for="rePass" class="form-label">Confirm your password</label>
                <div *ngIf="inRePass.dirty && inRePass.errors?.['required']" class="invalid-feedback fs-6">
                    This field is required
                </div>
                <div *ngIf="inRePass.dirty && inRePass.value !== inPass.value" class="invalid-feedback fs-6">
                    The passwords do not match
                </div>
                <div *ngIf="inRePass.valid && inRePass.value === inPass.value" class="valid-feedback fs-6">
                    The field is valid</div>
            </div>
            <a class="register-vertify" routerLink="/login">Already have an account?</a>
            <div class="form-submit mt-4">
                <input [disabled]="regForm.invalid || inRePass.value !== inPass.value" type="submit" value="Register"
                    class="submit" id="submit" name="submit" />
            </div>
        </form>
    </div>
</div>